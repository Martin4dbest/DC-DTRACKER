If you want to simplify the process so that after the admin confirms a donation and uploads a receipt image or file, they can view it directly by clicking the file, you can make a few adjustments.

Steps:
Add an upload field for the receipt file in your donation confirmation form.
Store the file in a designated folder.
Make sure the file path or URL is saved in the database.
Allow the admin to click on the file in the admin panel to view it.
Here's how you could adjust your system:
Update the Donation Model: Ensure you have a field to store the file path for the uploaded receipt.
python
Copy code
class Donation(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    user_id = db.Column(db.Integer, db.ForeignKey('user.id'), nullable=False)
    amount = db.Column(db.Float, nullable=False)
    donation_date = db.Column(db.DateTime, nullable=False, default=datetime.utcnow)
    receipt_file = db.Column(db.String(255), nullable=True)  # Field to store the file path

    user = db.relationship('User', backref=db.backref('donations', lazy=True))
Create a Form for Uploading the Receipt: In your donation confirmation page or admin panel, you will have a file input field for uploading the receipt.
html
Copy code
<form method="POST" enctype="multipart/form-data">
    <label for="receipt">Upload Receipt:</label>
    <input type="file" name="receipt" id="receipt" required>
    <button type="submit">Confirm Donation</button>
</form>
Handle the File Upload in Your Route:
python
Copy code
import os
from werkzeug.utils import secure_filename

# Set a folder for saving files (make sure to create the folder if it doesn't exist)
UPLOAD_FOLDER = 'static/uploads/receipts/'
ALLOWED_EXTENSIONS = {'pdf', 'jpg', 'jpeg', 'png'}

app.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER

def allowed_file(filename):
    return '.' in filename and filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS

@app.route('/confirm_donation', methods=['POST'])
def confirm_donation():
    if 'receipt' not in request.files:
        flash('No file part')
        return redirect(request.url)
    file = request.files['receipt']
    if file.filename == '':
        flash('No selected file')
        return redirect(request.url)
    
    if file and allowed_file(file.filename):
        filename = secure_filename(file.filename)
        file_path = os.path.join(app.config['UPLOAD_FOLDER'], filename)
        file.save(file_path)
        
        # Save the file path in the database
        new_donation = Donation(
            user_id=current_user.id,
            amount=request.form['amount'],
            receipt_file=file_path
        )
        db.session.add(new_donation)
        db.session.commit()
        
        flash('Donation confirmed and receipt uploaded successfully!')
        return redirect(url_for('view_receipts'))
    else:
        flash('Invalid file format. Only PDF, JPG, JPEG, PNG allowed.')
        return redirect(request.url)
Display the Uploaded Receipt in the Admin Panel:
In your admin dashboard or receipt overview page, you'll allow the admin to click the file link and view it directly.

html
Copy code
<!-- In your receipts overview page -->
<table>
    <thead>
        <tr>
            <th>Receipt ID</th>
            <th>Partner Name</th>
            <th>Donation Amount</th>
            <th>Date</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for receipt in receipts %}
            <tr>
                <td>{{ receipt.id }}</td>
                <td>{{ receipt.user.name }}</td>
                <td>${{ receipt.amount }}</td>
                <td>{{ receipt.donation_date }}</td>
                <td>
                    {% if receipt.receipt_file %}
                        <a href="{{ url_for('static', filename='uploads/receipts/' + receipt.receipt_file.split('/')[-1]) }}" target="_blank">View Receipt</a>
                    {% else %}
                        No receipt uploaded
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>
Key Changes:
File Upload Handling: The file is uploaded and stored in the static/uploads/receipts/ directory.
Database Field: A receipt_file column is added to store the file path.
Admin View: The admin can view the file by clicking a link that opens the file in a new tab.
This simplifies the process of viewing receipts as the admin can directly click on the link to view the uploaded file (image, PDF, etc.) without needing additional complex views.





















<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update User Details</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f7fc;
            margin: 0;
            padding: 0;
        }
        .container {
            width: 100%;
            max-width: 600px;
            margin: 50px auto;
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        form {
            display: flex;
            flex-direction: column;
        }
        label {
            margin-bottom: 8px;
            font-size: 14px;
            color: #555;
        }
        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        textarea {
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            color: #333;
        }
        input[type="text"]:read-only {
            background-color: #f5f5f5;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #0056b3;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group input,
        .form-group textarea {
            width: 100%;
        }
        a {
            display: inline-block;
            margin-top: 20px;
            text-align: center;
            color: #007bff;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Update Your Details</h1>
        
        <form method="POST">
            {{ form.hidden_tag() }}

            <!-- Prefill fields with current user data, but make 'name' and 'password' readonly -->
            <div class="form-group">
                <label for="name">Name</label>
                <input type="text" class="form-control" id="name" name="name" value="{{ current_user.name }}" readonly>
            </div>

            <div class="form-group">
                <label for="email">Email</label>
                {{ form.email(class="form-control", placeholder="Enter your email address", value=current_user.email) }}
            </div>

            <div class="form-group">
                <label for="phone">Phone</label>
                {{ form.phone(class="form-control", placeholder="Enter your phone number", value=current_user.phone) }}
            </div>

            <div class="form-group">
                <label for="address">Address</label>
                {{ form.address(class="form-control", placeholder="Enter your address", value=current_user.address) }}
            </div>

            <div class="form-group">
                <label for="country">Country</label>
                {{ form.country(class="form-control", placeholder="Enter your country", value=current_user.country) }}
            </div>

            <div class="form-group">
                <label for="state">State</label>
                {{ form.state(class="form-control", placeholder="Enter your state", value=current_user.state) }}
            </div>

            <div class="form-group">
                <label for="church_branch">Church Branch</label>
                {{ form.church_branch(class="form-control", placeholder="Enter your church branch", value=current_user.church_branch) }}
            </div>

            <div class="form-group">
                <label for="birthday">Birthday</label>
                {{ form.birthday(class="form-control", placeholder="Enter your birthday", value=current_user.birthday.strftime('%Y-%m-%d') if current_user.birthday else '') }}
            </div>

            <!-- Exclude password from the form as it should not be changed -->
            <div class="form-group">
                <label for="password">Password</label>
                <input type="text" class="form-control" id="password" name="password" value="********" readonly>
            </div>

            <div class="form-group">
                <button type="submit">Update</button>
            </div>
        </form>

        <a href="{{ url_for('home2') }}">Back to Home</a>
    </div>
</body>
</html>
